## ðŸ‡¬ðŸ‡§ English

# LukitaPort

Port scanner with a real-time web interface. The FastAPI backend streams results as each port is scanned â€” no waiting for the full scan to finish. Includes fingerprinting, advanced security audit, CVE lookup, network discovery, subdomain enumeration, anonymous mode, and multi-format export.

> **Warning:** For educational use only. Only scan systems you own or have explicit written permission to test. Unauthorized port scanning may be illegal in your jurisdiction.

---

## What it does

LukitaPort opens TCP connections against each port of the target and classifies the result:

- **Open** â€” connection succeeded. Something is listening on that port.
- **Closed** â€” connection refused. The port is reachable but no service is running.
- **Filtered** â€” timed out. A firewall is probably dropping the packets.

Results stream to the browser live via **Server-Sent Events (SSE)** â€” the backend yields one JSON event per port as it scans, the frontend renders them in the table as they arrive.

---

## Scan modes

| Mode | Ports | When to use |
|---|---|---|
| Quick | 30 common ports | Fast check of typical services |
| Custom | User-defined range | When you know what range you care about |
| Full | 1â€“65535 | Full audit (can take several minutes) |

---

## Intensity profiles

| Profile | Concurrency | Delay | Notes |
|---|---|---|---|
| Normal | 100 simultaneous | None | Balanced, default |
| Stealth | 10 simultaneous | 0.5s per port | IDS/firewall evasion |
| Aggressive | 1000 simultaneous | None | Maximum speed |

---

## Anonymous mode

Enabling **Anonymous Mode** automatically forces the **Stealth** profile and adds random inter-port delays to minimize the scan's footprint on monitored networks. Toggle it in the scan configuration panel before starting.

---

## Risk labels

Open ports are tagged by potential risk:

- **High** â€” FTP (21), Telnet (23), SMTP (25), POP3 (110), NetBIOS (139), SMB (445), MSSQL (1433), Oracle (1521), MySQL (3306), RDP (3389), PostgreSQL (5432), VNC (5900), Redis (6379), MongoDB (27017), PPTP (1723).
- **Medium** â€” SSH (22), DNS (53), RPC (111), MSRPC (135), IMAP (143), HTTP-Alt (8080/8888), Elasticsearch (9200).
- **Low** â€” HTTP (80), HTTPS (443), SMTPS (465), SMTP/TLS (587), IMAPS (993), POP3S (995), HTTPS-Alt (8443).

---

## Fingerprinting

Click **Fingerprinting** after the scan to run nmap's `-sV` service detection against all open ports. Enriches the Version/Banner column and gives the CVE lookup precise version data.

> Requires nmap: `sudo apt install nmap` (Linux) Â· `winget install Insecure.Nmap` (Windows).

---

## Advanced audit

After the scan, if any web port (80, 443, 8080, 8443) is open, the **Advanced Audit** panel appears automatically with five tabs:

### ðŸ”’ HTTP Headers
Audits security headers. Each missing one gets a severity tag (High/Medium/Low) and a ready-to-copy nginx directive. Final score 0â€“100 and letter grade Aâ€“F.

### ðŸ”¬ Technologies
Detects CMS, frameworks, web servers, CDNs, analytics, and e-commerce platforms via Playwright. Results grouped by category.

### ðŸ—‚ Sensitive Paths
Checks known sensitive paths (admin panels, backups, config filesâ€¦). Reports 200 OK (accessible) vs 403 Forbidden (exists but blocked), with severity tags.

### ðŸ” SSL/TLS
Analyzes certificate and cipher config on open HTTPS ports. Detects expired certs, self-signed certs, weak ciphers (RC4, DESâ€¦), deprecated protocols (SSLv2/3, TLS 1.0/1.1). Grade: A/B/C/F.

### ðŸ› CVE
Queries the NVD for known CVEs affecting detected services. Run Fingerprinting first for version-aware results, or click **Search CVEs now** to run immediately.

> NVD free tier: 1 request per 6 seconds. 13 open ports â‰ˆ 85 seconds. Results cached 10 min.

---

## OSINT & Network Discovery

Panel below the scan configuration:

### Ping Sweep (CIDR)
Enter a CIDR range (e.g. `192.168.1.0/24`) to discover live hosts. Click any result to load it as the scan target.

### Subdomain Enumeration
Enter a domain to enumerate subdomains via crt.sh certificate transparency logs. Shows subdomain, resolved IP, cert expiry, and a one-click scan button.

---

## GeoIP enrichment

The target IP is automatically enriched with country, city, ISP, and ASN data during the scan, shown in the status bar.

---

## Export formats

| Format | Generated by | Contents |
|---|---|---|
| JSON | Client | Full scan + metadata + GeoIP + versions |
| CSV | Client | Port, state, service, risk, response time, version |
| HTML | Client | Self-contained visual report |
| PDF | Server (ReportLab) | Formatted report with audit data + optional screenshot |
| Markdown | Server | .md report for documentation |

---

## Project structure

```
LukitaPort/
â”œâ”€â”€ main.py              # FastAPI server â€” all API endpoints
â”œâ”€â”€ scanner.py           # Async port scanning, banner grabbing, nmap fingerprinting
â”œâ”€â”€ resolver.py          # DNS resolution and IP validation
â”œâ”€â”€ auditor.py           # HTTP headers, WAF, technologies, sensitive paths
â”œâ”€â”€ ssl_analyzer.py      # SSL/TLS certificate and cipher analysis
â”œâ”€â”€ cve_lookup.py        # NVD CVE lookup with async HTTP and TTL cache
â”œâ”€â”€ pdf_generator.py     # PDF report generation (ReportLab)
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ frontend/
    â”œâ”€â”€ index.html
    â”œâ”€â”€ styles.css
    â”œâ”€â”€ main.js
    â”œâ”€â”€ api.js
    â”œâ”€â”€ ui.js
    â”œâ”€â”€ state.js
    â””â”€â”€ export.js
```

---

## Installation

Requires Python 3.10+ and nmap.

```bash
git clone https://github.com/jaimefg1888/LukitaPort
cd LukitaPort

python -m venv venv
source venv/bin/activate        # Linux/macOS
venv\Scripts\activate           # Windows

pip install -r requirements.txt
playwright install chromium --with-deps
```

---

## Usage

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

Open `http://localhost:8000`, enter a target IP or domain, pick a mode and profile, and hit **Start Scan**.

---

## Docker

```bash
docker compose up --build
docker compose up -d
```

Open `http://localhost:8000`. nmap and Playwright/Chromium are included in the image.

---

## Technical notes

- Async scan uses `asyncio` + semaphore. Concurrency controlled by profile (10 / 100 / 1000).
- Full scan (1â€“65535) can take 1â€“20 min depending on timeout and network.
- CVE results cached in memory for 10 min to stay within NVD rate limits.
- Screenshots are captured by Playwright in the background, don't block anything.

---

## License

MIT. See the LICENSE file.

**Author:** jaimefg1888

---
---

## ðŸ‡ªðŸ‡¸ EspaÃ±ol

# LukitaPort

EscÃ¡ner de puertos con interfaz web en tiempo real. El backend en FastAPI va enviando los resultados puerto a puerto segÃºn los escanea, sin esperar a que termine todo. Incluye fingerprinting, auditorÃ­a de seguridad avanzada, bÃºsqueda de CVEs, descubrimiento de red, enumeraciÃ³n de subdominios, modo anÃ³nimo y exportaciÃ³n en mÃºltiples formatos.

> **Aviso:** Solo para uso educativo. Escanea Ãºnicamente sistemas propios o sobre los que tengas autorizaciÃ³n escrita. El escaneo no autorizado puede ser ilegal en tu jurisdicciÃ³n.

---

## QuÃ© hace

LukitaPort abre conexiones TCP contra cada puerto del objetivo y clasifica el resultado:

- **Abierto** â€” la conexiÃ³n se estableciÃ³. Hay algo escuchando.
- **Cerrado** â€” la conexiÃ³n fue rechazada. El puerto responde pero no hay servicio.
- **Filtrado** â€” timeout. Probablemente un firewall estÃ¡ descartando los paquetes.

Los resultados llegan al navegador en tiempo real mediante **Server-Sent Events (SSE)** â€” el backend hace yield de un evento JSON por puerto mientras escanea, y el frontend los va pintando en la tabla segÃºn llegan.

---

## Modos de escaneo

| Modo | Puertos | CuÃ¡ndo usarlo |
|---|---|---|
| RÃ¡pido | 30 puertos comunes | RevisiÃ³n rÃ¡pida de servicios habituales |
| Personalizado | Rango definido | Cuando sabes quÃ© rango te interesa |
| Completo | 1â€“65535 | AuditorÃ­a exhaustiva (puede tardar varios minutos) |

---

## Perfiles de intensidad

| Perfil | Concurrencia | Delay | Notas |
|---|---|---|---|
| Normal | 100 simultÃ¡neas | Ninguno | Equilibrado, por defecto |
| Stealth | 10 simultÃ¡neas | 0,5s por puerto | EvasiÃ³n de IDS/firewall |
| Agresivo | 1000 simultÃ¡neas | Ninguno | MÃ¡xima velocidad |

---

## Modo anÃ³nimo

Al activar el **Modo AnÃ³nimo** se fuerza el perfil **Stealth** y se aÃ±aden delays aleatorios entre puertos para minimizar la huella en redes monitorizadas. ActÃ­valo en el panel de configuraciÃ³n antes de iniciar el escaneo.

---

## Niveles de riesgo

- **Alto** â€” FTP (21), Telnet (23), SMTP (25), POP3 (110), NetBIOS (139), SMB (445), MSSQL (1433), Oracle (1521), MySQL (3306), RDP (3389), PostgreSQL (5432), VNC (5900), Redis (6379), MongoDB (27017), PPTP (1723).
- **Medio** â€” SSH (22), DNS (53), RPC (111), MSRPC (135), IMAP (143), HTTP-Alt (8080/8888), Elasticsearch (9200).
- **Bajo** â€” HTTP (80), HTTPS (443), SMTPS (465), SMTP/TLS (587), IMAPS (993), POP3S (995), HTTPS-Alt (8443).

---

## Fingerprinting

Haz clic en **Fingerprinting** tras el escaneo para ejecutar `-sV` de nmap sobre todos los puertos abiertos. Rellena la columna VersiÃ³n/Banner y mejora los resultados del CVE.

> Requiere nmap: `sudo apt install nmap` (Linux) Â· `winget install Insecure.Nmap` (Windows).

---

## AuditorÃ­a avanzada

Tras el escaneo, si hay algÃºn puerto web abierto (80, 443, 8080, 8443), aparece el panel de **AuditorÃ­a Avanzada** con cinco pestaÃ±as:

### ðŸ”’ Cabeceras HTTP
Audita las cabeceras de seguridad. Cada cabecera ausente incluye severidad y directiva nginx para copiar. PuntuaciÃ³n 0â€“100 y nota Aâ€“F.

### ðŸ”¬ TecnologÃ­as
Detecta CMS, frameworks, servidores web, CDNs, analÃ­tica y plataformas de e-commerce con Playwright. Resultados agrupados por categorÃ­a.

### ðŸ—‚ Rutas sensibles
Comprueba rutas conocidas (paneles de admin, backups, configsâ€¦). Informa de 200 OK vs 403 Forbidden, con etiquetas de severidad.

### ðŸ” SSL/TLS
Analiza el certificado y el cifrado en puertos HTTPS. Detecta certificados expirados, autofirmados, cifrados dÃ©biles (RC4, DESâ€¦), protocolos obsoletos (SSLv2/3, TLS 1.0/1.1). Nota: A/B/C/F.

### ðŸ› CVE
Consulta el NVD en busca de CVEs conocidos. Ejecuta Fingerprinting primero para resultados precisos, o haz clic en **Buscar CVEs ahora**.

> NVD gratuito: 1 peticiÃ³n cada 6 segundos. 13 puertos â‰ˆ 85 segundos. CachÃ© de 10 min.

---

## OSINT & Descubrimiento de red

Panel situado bajo la configuraciÃ³n del escaneo:

### Ping Sweep (CIDR)
Introduce un rango CIDR (p. ej. `192.168.1.0/24`) para descubrir hosts activos. Haz clic en cualquier resultado para cargarlo como objetivo.

### EnumeraciÃ³n de subdominios
Introduce un dominio para enumerar subdominios vÃ­a crt.sh. Muestra el subdominio, IP resuelta, expiraciÃ³n del certificado y botÃ³n para escanearlo.

---

## Enriquecimiento GeoIP

La IP del objetivo se enriquece automÃ¡ticamente con paÃ­s, ciudad, ISP y ASN durante el escaneo, visible en la barra de estado.

---

## Formatos de exportaciÃ³n

| Formato | Generado por | Contenido |
|---|---|---|
| JSON | Cliente | Datos completos + metadatos + GeoIP + versiones |
| CSV | Cliente | Puerto, estado, servicio, riesgo, tiempo, versiÃ³n |
| HTML | Cliente | Informe visual autocontenido |
| PDF | Servidor (ReportLab) | Informe formateado con auditorÃ­a + screenshot |
| Markdown | Servidor | Informe .md para documentaciÃ³n |

---

## Estructura del proyecto

```
LukitaPort/
â”œâ”€â”€ main.py
â”œâ”€â”€ scanner.py
â”œâ”€â”€ resolver.py
â”œâ”€â”€ auditor.py
â”œâ”€â”€ ssl_analyzer.py
â”œâ”€â”€ cve_lookup.py
â”œâ”€â”€ pdf_generator.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â””â”€â”€ frontend/
    â”œâ”€â”€ index.html
    â”œâ”€â”€ styles.css
    â”œâ”€â”€ main.js
    â”œâ”€â”€ api.js
    â”œâ”€â”€ ui.js
    â”œâ”€â”€ state.js
    â””â”€â”€ export.js
```

---

## InstalaciÃ³n

Requiere Python 3.10+ y nmap.

```bash
git clone https://github.com/jaimefg1888/LukitaPort
cd LukitaPort

python -m venv venv
source venv/bin/activate        # Linux/macOS
venv\Scripts\activate           # Windows

pip install -r requirements.txt
playwright install chromium --with-deps
```

---

## Uso

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

Abre `http://localhost:8000`, escribe la IP o dominio, elige el modo y perfil, y pulsa **Iniciar Escaneo**.

---

## Docker

```bash
docker compose up --build
docker compose up -d
```

Abre `http://localhost:8000`. nmap y Playwright/Chromium incluidos en la imagen.

---

## Notas tÃ©cnicas

- Escaneo async con `asyncio` + semÃ¡foro. Concurrencia controlada por el perfil (10 / 100 / 1000).
- Modo completo (1â€“65535): entre 1 y 20 minutos segÃºn timeout y red.
- CVEs cacheados en memoria 10 minutos para no superar el lÃ­mite del NVD.
- Screenshots con Playwright en background, sin bloquear el escaneo ni la auditorÃ­a.

---

## Licencia

MIT. Consulta el archivo LICENSE.

**Autor:** jaimefg1888
